<ion-header [translucent]="true">
  <ion-toolbar class="bg-white shadow-sm">
    <ion-title class="flex items-center justify-center gap-2">
      <span class="text-lg font-semibold text-blue-600">FASTPASS</span>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content fullscreen>

  <!-- ðŸ—º MAP -->
  <div class="map-container">
    <div class="map-grid"></div>

    <div
      class="marker"
      *ngFor="let lot of visibleParkingLots"
      [style.left]="lot.mapX + 'px'"
      [style.top]="lot.mapY + 'px'"
      [ngClass]="getMarkerColor(lot.available, lot.capacity)"
      (click)="viewLotDetails(lot)"
    >
      {{ lot.available ?? 0 }}
    </div>
  </div>

  <!-- ðŸ§¾ BOTTOM SHEET -->
  <div
    class="bottom-sheet"
    [ngStyle]="{
      height: sheetLevel === 1 ? '30vh' : '75vh'
    }"
  >
    <!-- DRAG HEADER -->
    <div
      class="drag-header"
      (mousedown)="startDrag($event)"
      (touchstart)="startDrag($event)"
    >
      <div class="drag-line"></div>
    </div>

    <!-- CONTENT SCROLL AREA -->
    <div
      class="sheet-content"
      [class.lock-scroll]="!canScroll"
      
    >


      <!-- SEARCH BAR -->
      <ion-searchbar
        [(ngModel)]="searchQuery"
        placeholder="à¸„à¹‰à¸™à¸«à¸²à¸—à¸µà¹ˆà¸ˆà¸­à¸”à¸£à¸–..."
        (ionChange)="onSearch()"
      ></ion-searchbar>

      <!-- FILTER BUTTONS -->
      <div class="filter-row">
        <ion-segment [(ngModel)]="selectedTab" (ionChange)="onTabChange()">
          <ion-segment-button value="normal">
            <ion-label>à¸—à¸±à¹ˆà¸§à¹„à¸›</ion-label>
          </ion-segment-button>

          <ion-segment-button value="ev">
            <ion-label>EV</ion-label>
          </ion-segment-button>

          <ion-segment-button value="motorcycle">
            <ion-label>à¸¡à¸­à¹„à¸‹à¸„à¹Œ</ion-label>
          </ion-segment-button>
        </ion-segment>
      </div>

      <!-- LIST -->
      <div class="lot-list">
        <div
          class="lot-card"
          *ngFor="let lot of filteredParkingLots"
          (click)="viewLotDetails(lot)"
        >
          <div class="lot-header">
            <h3>{{ lot.name }}</h3>
            <span
              class="status"
              [ngClass]="getStatusColor(lot.status)"
            >{{ getStatusText(lot.status) }}</span>
          </div>

          <p class="text-sm text-gray-600">
            {{ lot.available }} / {{ lot.capacity }} à¸„à¸±à¸™
          </p>

          <p class="text-xs text-gray-400">{{ lot.hours }}</p>
        </div>
      </div>

    </div>
  </div>
</ion-content>
